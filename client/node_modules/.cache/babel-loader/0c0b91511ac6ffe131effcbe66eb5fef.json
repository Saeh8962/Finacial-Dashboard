{"ast":null,"code":"import _classCallCheck from \"/Users/samehrlich/Desktop/final-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/samehrlich/Desktop/final-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"/Users/samehrlich/Desktop/final-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"/Users/samehrlich/Desktop/final-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"/Users/samehrlich/Desktop/final-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";\nvar _jsxFileName = \"/Users/samehrlich/Desktop/final-app/client/src/profile.js\";\nimport React, { Component, ChildComponent } from \"react\";\nimport { ListGroup } from \"react-bootstrap/esm\";\nimport { Button, DropdownMenu, Dropdown } from \"reactstrap/es\";\nimport { withRouter } from \"react-router-dom\";\nimport DrawerContainer from \"./layout/DrawerContainer\";\nimport \"./CSS/GlobalCSS.css\";\nimport \"./CSS/App.css\";\nimport './App.scss';\nimport SearchBar from './components/searchbar';\nimport WatchList from './components/WatchList';\nimport AllocationPanel from \"./panels/AllocationPanel\";\nimport PerformancePanel from \"./panels/PerformancePanel\"; // import 'react-dropdown/style.css';\n// import \"./CSS/legacyStyles.css\";\n// import { render } from \"react-dom\";\n\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar Profile = /*#__PURE__*/function (_Component) {\n  _inherits(Profile, _Component);\n\n  var _super = _createSuper(Profile);\n\n  function Profile(props) {\n    var _this;\n\n    _classCallCheck(this, Profile);\n\n    _this = _super.call(this, props);\n    _this.getEodData = _this.getEodData.bind(_assertThisInitialized(_this));\n    _this.getAlertData = _this.getAlertData.bind(_assertThisInitialized(_this));\n    _this.routeChange = _this.routeChange.bind(_assertThisInitialized(_this));\n\n    if (_this.props.location.state == null || _this.props.location.state[0] == null || _this.props.location.state[0][0] == null || _this.props.location.state[1] == null) {\n      _this.props.history.push(\"/error\");\n    } else {\n      if (_this.props.location.state[0][0].chartStock !== null) _this.state = {\n        email: _this.props.location.state[0][0].email,\n        stocks: _this.props.location.state[1],\n        stock_to_watch: \"\",\n        dropdownOpen: false,\n        value: \"Your Watchlist\",\n        Chart_stock: _this.props.location.state[0][0].chartStock\n      };else {\n        _this.state = {\n          email: _this.props.location.state[0][0].email,\n          stocks: _this.props.location.state[1],\n          stock_to_watch: \"\",\n          dropdownOpen: false,\n          value: \"Your Watchlist\"\n        };\n      }\n    }\n\n    return _this;\n  }\n\n  _createClass(Profile, [{\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps, prevState) {\n      var _this2 = this;\n\n      if (prevProps.location.state[0][0].getStocks !== undefined) {\n        console.log('User has added a stock. Get new stocks');\n        this.getUserStocks();\n      }\n\n      if (prevProps.location.state[0][0].removeStocks !== this.props.location.state[0][0].RemoveStocks) {\n        console.log('User has Removed a stock. Get new stocks'); //update this function to grab eod Data\n\n        this.getUserStocks();\n      }\n\n      if (prevProps.location.state[0][0].chartStock !== this.props.location.state[0][0].chartStock) {\n        console.log('User has chosen a chart to display', this.props.location.state[0][0].chartStock);\n        this.setState({\n          Chart_stock: this.props.location.state[0][0].Chart_stock\n        }, function () {\n          return _this2.forceUpdate;\n        });\n      }\n    }\n  }, {\n    key: \"getEodData\",\n    value: function getEodData(symbols) {\n      var _this3 = this;\n\n      if (symbols !== 'No stocks added') {\n        var fetchData = function fetchData(symbols) {\n          var urls = symbols.map(function (symbol) {\n            var x = 'https://www.alphavantage.co/query?function=GLOBAL_QUOTE&symbol=' + symbol.Symbol + '&apikey=2TXPYH4TGZ32RG8D';\n            return x;\n          });\n          var allRequests = urls.map(function (url) {\n            return fetch(url).then(function (response) {\n              return response.json();\n            });\n          });\n          return Promise.all(allRequests);\n        };\n\n        var element = {\n          symbol: \"\",\n          eodClose: \"\",\n          eodPrice: \"\"\n        };\n        var watchlists = symbols;\n        ;\n        fetchData(symbols).then(function (result) {\n          var newList = watchlists.map(function (element, index) {\n            element = Object.entries(result[index]).map(function (entry) {\n              return entry[1];\n            });\n            return element[0];\n          }); // console.log(newList[0])\n\n          _this3.setState({\n            stocks: newList\n          });\n        });\n      } else {\n        console.log(\"No stocks added\");\n        return;\n      }\n    }\n  }, {\n    key: \"getUserStocks\",\n    value: function getUserStocks() {\n      var _this4 = this;\n\n      var user = {\n        email: this.state.email\n      };\n      console.log(user);\n      var url = \"/api/getUserStocks\";\n      var req = new Request(url, {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify(user)\n      });\n      fetch(req).then(function (res) {\n        return res.json();\n      }).catch(function (error) {\n        console.log(\"p/121\");\n        console.log(error);\n        return Promise.reject(error);\n      }).then(function (stock_results) {\n        console.log(\"3rdt ADD/remove Stock Rerender\");\n\n        _this4.getEodData(stock_results);\n      });\n    }\n  }, {\n    key: \"routeChange\",\n    value: function routeChange(value) {\n      if (value.target.id == \"Back\") {\n        this.props.history.push(\"/\", this.props.history.location.state);\n      } else if (value.target.id == \"Home\") {\n        this.props.history.push(\"/\", this.props.history.location.state);\n      }\n    }\n  }, {\n    key: \"getAlertData\",\n    value: function getAlertData(email, callback) {\n      var user = {\n        email: email,\n        request: \"getData\"\n      };\n      var url = \"/api/UserAlerts\";\n      var req = new Request(url, {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify(user)\n      });\n      fetch(req).then(function (res) {\n        //Catch server error\n        //no error\n        return res.json();\n      }).catch(function (error) {\n        console.log(error);\n        return Promise.reject(error);\n      }).then(function (query_result) {\n        console.log(query_result);\n        callback(query_result);\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var chart_symbol = \"\";\n\n      if (this.props.location.state[0][0].chartStock) {\n        chart_symbol = this.props.location.state[0][0].chartStock;\n      } // console.log(this.props.location.state[0][0].chartStock)\n      // var loginButton = <Button onClick={this.routeChange} className= \"Button\" id = \"Home\" >Home </Button>;\n\n\n      return /*#__PURE__*/_jsxDEV(DrawerContainer, {\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"App-header\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"panels\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"panel-info\",\n              children: /*#__PURE__*/_jsxDEV(SearchBar, {\n                stocks: this.props.location.state[1],\n                email: this.state.email\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 204,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 203,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"panel-info\",\n              children: /*#__PURE__*/_jsxDEV(PerformancePanel, {\n                symbol: chart_symbol\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 211,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 210,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"panel-positions\",\n              children: [/*#__PURE__*/_jsxDEV(WatchList, {\n                stocks: this.state.stocks,\n                email: this.state.email\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 215,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(AllocationPanel, {\n                email: this.state.email\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 216,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 214,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 201,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 200,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 198,\n        columnNumber: 9\n      }, this);\n    }\n  }]);\n\n  return Profile;\n}(Component);\n\nexport default _c = withRouter(Profile);\n\nvar _c;\n\n$RefreshReg$(_c, \"%default%\");","map":{"version":3,"sources":["/Users/samehrlich/Desktop/final-app/client/src/profile.js"],"names":["React","Component","ChildComponent","ListGroup","Button","DropdownMenu","Dropdown","withRouter","DrawerContainer","SearchBar","WatchList","AllocationPanel","PerformancePanel","Profile","props","getEodData","bind","getAlertData","routeChange","location","state","history","push","chartStock","email","stocks","stock_to_watch","dropdownOpen","value","Chart_stock","prevProps","prevState","getStocks","undefined","console","log","getUserStocks","removeStocks","RemoveStocks","setState","forceUpdate","symbols","fetchData","urls","map","symbol","x","Symbol","allRequests","url","fetch","then","response","json","Promise","all","element","eodClose","eodPrice","watchlists","result","newList","index","Object","entries","entry","user","req","Request","method","headers","body","JSON","stringify","res","catch","error","reject","stock_results","target","id","callback","request","query_result","chart_symbol"],"mappings":"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","sourcesContent":["import React,{Component,ChildComponent} from \"react\";\nimport {ListGroup} from \"react-bootstrap/esm\";\nimport {Button,DropdownMenu,Dropdown} from \"reactstrap/es\";\nimport {withRouter} from \"react-router-dom\";\nimport DrawerContainer from \"./layout/DrawerContainer\";\n\nimport \"./CSS/GlobalCSS.css\";\nimport \"./CSS/App.css\";\nimport './App.scss';\nimport SearchBar from './components/searchbar'\nimport WatchList from './components/WatchList'\nimport AllocationPanel from \"./panels/AllocationPanel\";\nimport PerformancePanel from \"./panels/PerformancePanel\";\n// import 'react-dropdown/style.css';\n// import \"./CSS/legacyStyles.css\";\n\n// import { render } from \"react-dom\";\n\nclass Profile extends Component { \n    \n    constructor(props){\n        super(props);\n\n        this.getEodData=this.getEodData.bind(this);\n        this.getAlertData=this.getAlertData.bind(this);\n        this.routeChange = this.routeChange.bind(this);\n        \n             \n        if(this.props.location.state == null || this.props.location.state[0] == null || this.props.location.state[0][0] == null || this.props.location.state[1] == null){\n            this.props.history.push(\"/error\");\n            }\n        else{\n            if(this.props.location.state[0][0].chartStock !== null)\n            this.state={  \n                email: this.props.location.state[0][0].email ,\n                stocks: this.props.location.state[1],\n                stock_to_watch:\"\",\n                dropdownOpen: false,\n                value:\"Your Watchlist\",\n                Chart_stock:this.props.location.state[0][0].chartStock\n                \n            }\n            else{\n                this.state={  \n                    email: this.props.location.state[0][0].email ,\n                    stocks: this.props.location.state[1],\n                    stock_to_watch:\"\",\n                    dropdownOpen: false,\n                    value:\"Your Watchlist\",\n                    \n                    \n                } \n            }\n        }\n           \n        \n    }\n    componentDidUpdate(prevProps, prevState) {\n        if (prevProps.location.state[0][0].getStocks !==undefined) {\n          console.log('User has added a stock. Get new stocks')\n          this.getUserStocks()\n          \n        }\n        if (prevProps.location.state[0][0].removeStocks !== this.props.location.state[0][0].RemoveStocks) {\n            console.log('User has Removed a stock. Get new stocks')\n            //update this function to grab eod Data\n            this.getUserStocks()\n            \n          }\n          if (prevProps.location.state[0][0].chartStock !== this.props.location.state[0][0].chartStock) {\n            console.log('User has chosen a chart to display',this.props.location.state[0][0].chartStock)\n            this.setState({Chart_stock:this.props.location.state[0][0].Chart_stock},()=>this.forceUpdate)\n        \n            \n          }\n        \n      }\n      getEodData(symbols){\n        if(symbols !== 'No stocks added'){\n          var element = {\n            symbol:\"\",\n            eodClose:\"\",\n            eodPrice:\"\"\n          }\n          var watchlists = symbols;\n          function fetchData(symbols){\n            const urls = symbols.map(symbol => {\n              var x = 'https://www.alphavantage.co/query?function=GLOBAL_QUOTE&symbol='+symbol.Symbol+'&apikey=2TXPYH4TGZ32RG8D';\n              return x;\n            })\n          \n            const allRequests = urls.map(url => \n              fetch(url).then(response => response.json())\n            );\n          \n            return Promise.all(allRequests);\n          };\n        fetchData(symbols).then(result => {\n         var newList = watchlists.map((element, index) =>{\n          element= Object.entries(result[index]).map(entry => {return entry[1]});\n          return element[0]\n        })\n        // console.log(newList[0])\n      this.setState({stocks:newList});\n      })\n     \n        \n      }\n        else{\n          console.log(\"No stocks added\")\n          return;\n        }\n      }\n\n      getUserStocks(){\n  \n        var user={ \n            email: this.state.email,\n        }\n        console.log(user);\n        var url = \"/api/getUserStocks\";\n        const req = new Request(url,{\n            method:\"POST\",\n            headers:{\"Content-Type\":\"application/json\"},\n            body:JSON.stringify(user),\n        });\n        fetch(req)\n        .then((res)=>{\n           \n            return res.json();\n        }).catch((error)=>{\n            console.log(\"p/121\");\n            console.log(error);\n            return Promise.reject(error);\n            })\n        .then(stock_results => {\n            console.log(\"3rdt ADD/remove Stock Rerender\");\n            this.getEodData(stock_results);\n            });\n        \n      }\n      \n    \n \n    \n    \n\n\nrouteChange(value){\n    if (value.target.id==\"Back\"){\n        this.props.history.push(\"/\",this.props.history.location.state);\n    }\n    else if(value.target.id==\"Home\"){\n        this.props.history.push(\"/\",this.props.history.location.state);\n    }\n}\ngetAlertData(email,callback){\n    var user = {\n        email:email,\n        request:\"getData\"\n    }\n    var url=\"/api/UserAlerts\";\n            const req = new Request(url,{\n                method:\"POST\",\n                headers:{\"Content-Type\":\"application/json\"},\n                body:JSON.stringify(user),\n            });\n            \n            fetch(req)\n            .then((res)=>{\n                //Catch server error\n                    //no error\n                    \n                return res.json();\n            }).catch((error)=>{\n                console.log(error);\n                return Promise.reject(error);\n            })\n            .then(query_result=>{\n                console.log(query_result);\n                callback(query_result)\n            }) \n    \n}\n\n\nrender(){\n    var chart_symbol=\"\";\n\n    if(this.props.location.state[0][0].chartStock){\n        chart_symbol =this.props.location.state[0][0].chartStock;\n    }\n    // console.log(this.props.location.state[0][0].chartStock)\n\n    // var loginButton = <Button onClick={this.routeChange} className= \"Button\" id = \"Home\" >Home </Button>;\n    return(\n       \n        <DrawerContainer>\n           \n            <div className=\"App-header\">\n            <div className=\"panels\">\n            \n                <div className=\"panel-info\">\n                <SearchBar stocks= {this.props.location.state[1]} email= {this.state.email} /> \n                \n                </div>\n                {/* <div className=\"panel-info\">\n                   \n                </div> */}\n                <div className=\"panel-info\">\n                    <PerformancePanel symbol={chart_symbol}/>\n                  \n                </div>\n                <div className=\"panel-positions\">\n                <WatchList stocks={this.state.stocks}email= {this.state.email}/>\n                <AllocationPanel email={this.state.email}/>\n                </div>\n        </div>\n            </div>\n            \n   </DrawerContainer>\n    )\n    }\n\n\n}\nexport default withRouter(Profile);"]},"metadata":{},"sourceType":"module"}
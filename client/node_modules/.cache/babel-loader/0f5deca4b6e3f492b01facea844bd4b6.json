{"ast":null,"code":"import _objectSpread from \"/Users/samehrlich/Desktop/final-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _assertThisInitialized from \"/Users/samehrlich/Desktop/final-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _classCallCheck from \"/Users/samehrlich/Desktop/final-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/samehrlich/Desktop/final-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"/Users/samehrlich/Desktop/final-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"/Users/samehrlich/Desktop/final-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";\nvar _jsxFileName = \"/Users/samehrlich/Desktop/final-app/client/src/components/WatchList.jsx\";\nimport React, { Component, ChildComponent } from \"react\";\nimport { ListGroup } from \"react-bootstrap/esm\";\nimport { Button, DropdownMenu, Dropdown } from \"reactstrap/es\"; // import {Tooltip,OverlayTrigger} from \"react-bootstrap\"\n\nimport { withRouter } from \"react-router-dom\";\nimport { Grid, GridCellProps, GridColumn } from \"@progress/kendo-react-grid\";\nimport * as ReactDOM from \"react-dom\";\nimport { Tooltip } from \"@progress/kendo-react-tooltip\";\nimport OverlayTrigger from 'react-bootstrap/OverlayTrigger';\nimport { MyCommandCell } from \"./mycommand.jsx\";\nimport \"hammerjs\";\nimport { sendEmail } from \"./email.js\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar request = require('request');\n\nfunction add$sign(props) {\n  var Value = props.dataItem[props.field || \"\"];\n  return /*#__PURE__*/_jsxDEV(\"td\", {\n    children: \"$\" + Value\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 19,\n    columnNumber: 5\n  }, this);\n}\n\nfunction ChangeCurPriceColor(props) {\n  var curValue = props.dataItem[props.field || \"\"];\n  var closeValue = props.dataItem[\"eodClose\" || \"\"]; // console.log(curValue,closeValue)\n\n  return /*#__PURE__*/_jsxDEV(\"td\", {\n    style: {\n      color: curValue > closeValue ? \"green\" : \"red\"\n    },\n    children: \"$\" + curValue\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 29,\n    columnNumber: 5\n  }, this);\n}\n\n_c = ChangeCurPriceColor;\n;\n\nfunction ChangeCurChangeColor(props) {\n  var value = props.dataItem[props.field || \"\"] > 0 ? \"+\" + props.dataItem[props.field] : props.dataItem[props.field || \"\"]; // console.log(curValue,closeValue)\n\n  return /*#__PURE__*/_jsxDEV(\"td\", {\n    style: {\n      color: value > 0 ? \"green\" : \"red\"\n    },\n    children: [value, \"%\"]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 40,\n    columnNumber: 5\n  }, this);\n}\n\n_c2 = ChangeCurChangeColor;\n;\n\nvar viewChartOver = /*#__PURE__*/function (_React$Component) {\n  _inherits(viewChartOver, _React$Component);\n\n  var _super = _createSuper(viewChartOver);\n\n  function viewChartOver() {\n    _classCallCheck(this, viewChartOver);\n\n    return _super.apply(this, arguments);\n  }\n\n  _createClass(viewChartOver, [{\n    key: \"render\",\n    value: function render() {\n      return /*#__PURE__*/_jsxDEV(\"td\", {\n        title: \"View chart\",\n        children: \"view the char\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 49,\n        columnNumber: 7\n      }, this);\n    }\n  }]);\n\n  return viewChartOver;\n}(React.Component);\n\nexport default withRouter( /*#__PURE__*/function (_React$Component2) {\n  _inherits(WatchList, _React$Component2);\n\n  var _super2 = _createSuper(WatchList);\n\n  function WatchList(props) {\n    var _this;\n\n    _classCallCheck(this, WatchList);\n\n    _this = _super2.call(this, props);\n\n    _this.saveNewStockTrade = function (event) {\n      var result = JSON.parse(event.data); // console.log(result)\n\n      var Alerts = _this.state.user_alerts;\n      var user_watchlist = _this.state.stocks; // console.log(\"InsidesaveNewStockTrade: \", user_watchlist)\n\n      if (result.type === \"trade\") {\n        user_watchlist.forEach(function (symbol) {\n          var tradePrice = result.data.filter(function (i, n) {\n            return i.s === symbol.Symbol;\n          });\n\n          if (tradePrice.length !== 0) {\n            // symbol.eodClose= (symbol.eodClose*1).toFixed(2);\n            symbol.currentPrice = +tradePrice[tradePrice.length - 1].p.toFixed(2);\n            symbol.CurrentAmountChange = +(symbol.currentPrice - symbol.eodClose).toFixed(2);\n            symbol.CurrentPercentChange = +(symbol.CurrentAmountChange / symbol.eodClose * 100).toFixed(2); // console.log(\"Found Updated price for \",symbol.Symbol,\"\\n\",\"Price: \",symbol.currentPrice)\n            // console.log(\"Found Updating Amount Change, updated Change: \",symbol.CurrentAmountChange)\n            // console.log(\"Found Updating Percent Change, updated Change: \",symbol.CurrentPercentChange)\n            // socket.send(JSON.stringify({'type':'unsubscribe', 'symbol': symbol.name}))\n          }\n\n          if (Alerts.uniqueSymbols.includes(symbol.Symbol)) {\n            //check to see if the new price value triggered the alert\n            Alerts.alerts.forEach(function (alert) {\n              if (alert.symbol === symbol) {\n                switch (alert.Identifier) {\n                  case 'Price':\n                    switch (alert.movement) {\n                      case 'Above':\n                        {\n                          if (symbol.currentPrice > alert.valuechange) {\n                            alert(\"Your Price Alert watching for \" + symbol.Symbol + \" to go above: \" + alert.valuechange + \" has been triggered\");\n                            sendEmail(_this.state.email, alert);\n                            return \"Alert has been triggered\";\n                          }\n\n                          return \"Above Alert not triggered\";\n                        }\n\n                      case 'Below':\n                        {\n                          if (symbol.currentPrice < alert.valuechange) {\n                            alert(\"Your Price Alert watching for \" + symbol.Symbol + \" to go below: \" + alert.valuechange + \" has been triggered\");\n                            sendEmail(_this.state.email, alert);\n                            return \"Alert has been triggered\";\n                          }\n\n                          return \"Below Alert not triggered\";\n                        }\n\n                      default:\n                        return \"something went wrong\";\n                    }\n\n                  case 'Percent':\n                    switch (alert.movment) {\n                      case 'Up':\n                        {\n                          if (symbol.CurrentPercentChange > alert.valuechange) {\n                            alert(\"Your Percentage Alert watching for \" + symbol.Symbol + \" to be moving up: \" + alert.valuechange + \"% has been triggered\");\n                            sendEmail(_this.state.email, alert);\n                            return \"Alert has been triggered\";\n                          }\n\n                          return \"Up Alert not triggered\";\n                        }\n\n                      case 'Down':\n                        {\n                          if (symbol.CurrentPercentChange < alert.valuechange) {\n                            alert(\"Your Percentage Alert watching for \" + symbol.Symbol + \" to be moving down: \" + alert.valuechange + \"% has been triggered\");\n                            sendEmail(_this.state.email, alert);\n                            return \"Down Alert has been triggered\";\n                          }\n\n                          return \"Down Up Alert not triggered\";\n                        }\n\n                      default:\n                        return \"Down Alert not triggered\";\n                    }\n\n                  default:\n                    return \"something went wrong\";\n                }\n              }\n            });\n          }\n        });\n\n        _this.setState({\n          stocks: user_watchlist\n        });\n      }\n    };\n\n    _this.CommandCell = _this.CommandCell.bind(_assertThisInitialized(_this));\n    _this.getEodData = _this.getEodData.bind(_assertThisInitialized(_this));\n    _this.symbolCell = _this.symbolCell.bind(_assertThisInitialized(_this));\n    _this.removeStock = _this.removeStock.bind(_assertThisInitialized(_this));\n    _this.renderStockChart = _this.renderStockChart.bind(_assertThisInitialized(_this));\n    _this.removeHelper = _this.removeHelper.bind(_assertThisInitialized(_this)); // this.getButton=this.getButton.bind(this);\n\n    _this.state = {\n      email: _this.props.email,\n      stocks: _this.props.stocks,\n      AlertData: _this.props.alertData,\n      connectionError: false,\n      dropdownOpen: false,\n      value: \"Your Watchlist\",\n      stockHasBeenRemoved: false,\n      chartStock: \"\" // eodData:\"\"\n\n    };\n    return _this;\n  }\n\n  _createClass(WatchList, [{\n    key: \"symbolCell\",\n    value: function symbolCell(props) {\n      var _this2 = this;\n\n      var symbol = props.dataItem[props.field || \"\"];\n      return /*#__PURE__*/_jsxDEV(\"td\", {\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"button\",\n          className: \"btn btn-danger btn-circle btn-sm\",\n          onClick: function onClick(e) {\n            return _this2.removeStock(e, props.dataItem);\n          },\n          children: \"X\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 89,\n          columnNumber: 9\n        }, this), \" \", symbol]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 9\n      }, this);\n    }\n  }, {\n    key: \"CommandCell\",\n    value: function CommandCell(props) {\n      return /*#__PURE__*/_jsxDEV(MyCommandCell, _objectSpread(_objectSpread({}, props), {}, {\n        remove: this.removeStock\n      }), void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 9\n      }, this);\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps, prevState) {\n      var _this3 = this;\n\n      if (prevState.stockHasBeenRemoved !== this.state.stockHasBeenRemoved) {\n        console.log('User has removed a stock.');\n\n        if (this.props.history.push !== undefined) {\n          this.setState({\n            stockHasBeenRemoved: false\n          }, function () {\n            return _this3.props.history.push(\"/profile\", [[{\n              email: _this3.state.email,\n              removeStocks: true\n            }, _this3.state.stocks]]);\n          });\n        } else {\n          this.setState({\n            stocks: this.state.stocks\n          });\n        }\n      }\n\n      if (this.props.stocks.length != prevProps.stocks.length) {\n        console.log('Update stocks');\n        this.setState({\n          stocks: this.props.stocks\n        });\n      }\n\n      if (prevState.chartStock !== this.state.chartStock && this.state.chartStock !== \"\") {\n        var stock_chart = this.state.chartStock;\n        console.log(\"render chart for \", stock_chart);\n        this.setState({\n          chartStock: \"\"\n        }, function () {\n          return _this3.props.history.push(\"/profile\", [[{\n            email: _this3.state.email,\n            chartStock: stock_chart\n          }, _this3.state.stocks]]);\n        });\n      }\n    } // componentDidMount(){\n    //   // var data = getEodData(\"AAPL\");\n    //   // console.log(data);\n    //   // this.setState({eodData:data})\n    // }\n    //update this function to handle dynamic watchlist\n\n  }, {\n    key: \"getEodData\",\n    value: function getEodData(symbols) {\n      if (symbols !== 'No stocks added') {\n        var watchlists = symbols;\n        var getsymbols = \"\";\n        var result = [];\n        symbols.forEach(function (symbol) {\n          getsymbols = getsymbols + symbol.Symbol;\n          var fullUrl = 'https://www.alphavantage.co/query?function=GLOBAL_QUOTE&symbol=' + getsymbols + '&apikey=2TXPYH4TGZ32RG8D'; //  var fullUrl= \"http://api.marketstack.com/v1/eod/latest?access_key=5dd6fd84e5ba4e974843da4e6e23db23&symbols=\"+getsymbols;\n\n          request(fullUrl, {\n            json: true\n          }, function (err, res, body) {\n            if (err) {\n              return console.log(err);\n            }\n\n            var eod = body[\"Global Quote\"];\n            var keys = Object.keys(eod).map(function (key) {\n              return key;\n            }); // console.log(eod);\n\n            result.push(eod); //   var newList = watchlists.map((element, index) =>{\n            //     element.eodClose= (eod['05. price']*1).toFixed(2);\n            //     element.CurrentAmountChange= \"\";\n            //     element.CurrentPercentChange= \"\";\n            //     return element\n            //   })\n            //   console.log(newList)\n            // this.setState({stocks:newList});\n          });\n        });\n        console.log(result['0']);\n        var newList = watchlists.map(function (element, index) {\n          element.eodClose = (result[index]['05. price'] * 1).toFixed(2);\n          element.CurrentAmountChange = \"\";\n          element.CurrentPercentChange = \"\";\n          return element;\n        });\n        console.log(newList);\n        this.setState({\n          stocks: newList\n        });\n      } else {\n        console.log(\"No stocks added\");\n        return;\n      }\n    } //     getButton(){\n    //         return(\n    // <button className=\"k-button k-grid-remove-command\"onClick={(e) =>this.remove(e)}>Remove </button>\n    //         )\n    //     }\n    // remove(e,stocks){\n    //     console.log(stocks);\n    // }\n\n  }, {\n    key: \"componentWillMount\",\n    value: function componentWillMount() {\n      console.log(this.state.stocks);\n      this.connection = new WebSocket('wss://ws.finnhub.io?token=c34391qad3i8edlcgrgg');\n\n      if (this.state.stock !== 'No stocks added') {\n        this.getEodData(this.state.stocks);\n      }\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      var _this4 = this;\n\n      if (this.state.stock != \"No stocks added\") {\n        this.state.stocks.forEach(function (symbol) {\n          _this4.connection.send(JSON.stringify({\n            'type': 'unsubscribe',\n            'symbol': symbol.Symbol\n          }));\n        });\n      }\n\n      this.connection.close(); // Perform any necessary cleanup in this method, such as invalidating timers, canceling network requests, \n      // or cleaning up any subscriptions that were created in componentDidMount().\n    } // componentDidUpdate(prevProps, prevState) {\n    //     if (prevProps.stocks !== this.props.stocks) {\n    //       console.log('stocks state has changed.')\n    //     //   this.props.history.push(\"/profile\",[[{email:this.state.email}],this.state.stocks]);\n    //         this.setState({stocks:this.props.stocks});\n    //     }\n    //   }\n    // toggle(event) {\n    //     this.setState({\n    //       dropdownOpen: !this.state.dropdownOpen,\n    //       value: event.currentTarget.textContent\n    //     });\n    //   }\n\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this5 = this;\n\n      this.connection.onopen = function () {\n        if (_this5.state.stocks !== \"No stocks added\") {\n          _this5.state.stocks.forEach(function (symbol) {\n            _this5.connection.send(JSON.stringify({\n              'type': 'subscribe',\n              'symbol': symbol.Symbol\n            }));\n\n            console.log(\"Inside OnOpen: Subscribed To: \", symbol.Symbol);\n          });\n        } else {\n          console.log(\"no stocks added to subscribe to\");\n        }\n      };\n\n      this.connection.onmessage = this.saveNewStockTrade;\n\n      this.connection.onclose = function () {\n        _this5.setState({\n          connectionError: true\n        });\n      };\n    } // updateDropdown(){\n    //     var Message = \"Your WatchList\";\n    //     if(this.state.stocks===\"No stocks added\"){\n    //         Message =\"Empty Watchlist\"; \n    //     }\n    //     var MessageArrowDir;\n    //     if(this.state.dropdownOpen){\n    //       MessageArrowDir = \"\\u25BC\";\n    //     }\n    //     else{\n    //       MessageArrowDir = \"\\u25B2\";\n    //     }\n    //     var header =\n    //         <> <div className = \"dropDiv\">\n    //             <Button className = \"FakeDropDown\" onClick = {(e)=>{this.doNothing(e)}}><span style={{marginLeft:\"55px\"}}>{Message}</span></Button>\n    //             <Button className = \"realDropDown \"onClick = {this.toggle} aria-expanded = {this.state.dropdownOpen}\n    //                     data-toggle = \"dropdown\" aria-haspopup=\"true\"><span style={{fontSize:\"18px\"}}>{MessageArrowDir}</span></Button>\n    //         </div></>\n    //     if(this.state.stocks!==\"No stocks added\"){\n    //     var display = \n    //     <Dropdown style = {{marginBottom:\"20px\"}} isOpen={this.state.dropdownOpen}>\n    //         {header}\n    //         <DropdownMenu className = \"DDM\">\n    //           <div className = \"ArtistsDisplayWrapper\">\n    //             {this.state.stocks.map((stocks,index) =>\n    //         <div className = \"ArtistLine\" style = {{marginBottom:\"55px\"}}>\n    //             <button  onClick = {(e)=>{this.doNothing(e)}} className = \"artistButton\">{stocks.Symbol}</button>\n    //             <button id = {stocks.symbol} onClick = {(e)=>{this.doNothing(e)}} className = \"playArtistButton\">${stocks.currentPrice}</button>\n    //             <button onClick = {(e)=>{this.removeStock(e,stocks.Symbol)}} className = \"removeButton\">X</button> \n    //         </div>\n    //             )}\n    //           </div>\n    //         </DropdownMenu>\n    //     </Dropdown>\n    //     this.setState({dropdownDisplay:display});\n    //             }\n    //             else{\n    //                 this.setState({dropdownDisplay:header});\n    //             }\n    // }\n\n  }, {\n    key: \"removeStock\",\n    value: function removeStock(htmlEvent, stock) {\n      var _this6 = this;\n\n      //unsubsribe from listening to thsi stock\n      console.log(\"Unsubscribing from: \", stock.Symbol);\n      this.connection.send(JSON.stringify({\n        'type': 'unsubscribe',\n        'symbol': stock\n      })); //first stop the htmlEvents default status\n\n      htmlEvent.preventDefault();\n      var user = {\n        email: this.props.email,\n        stock_symbol: stock.Symbol\n      };\n      console.log(user);\n      var url = '/api/removeUserStock';\n      var req = new Request(url, {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify(user)\n      });\n      fetch(req).then(function (res) {\n        console.log(res);\n\n        if (res.status === 500) {\n          res.json().then(function (json) {\n            var message = json.message,\n                stackTrace = json.stackTrace;\n          }).catch(function (error) {\n            return Promise.reject(error);\n          });\n        } else {\n          return res.json();\n        }\n      }).then(function (result) {\n        console.log(\"1st remove stock rerender\");\n\n        _this6.setState({\n          remove_status: result\n        }, function () {\n          return _this6.removeHelper();\n        });\n      });\n    }\n  }, {\n    key: \"removeHelper\",\n    value: function removeHelper() {\n      console.log(\"p/179\", this.state.remove_status); //removed but still showing on watch list\n\n      if (this.state.remove_status.response === \"Stock not on watch list\") {\n        alert(\"Stock Queued For Deletion, Please Login In Again\");\n      } //stock has been removed from watchlist\n      else if (this.state.remove_status.Response === \"Sucessfully removed stock\") {\n          console.log(\"2nd remove stock rerender\");\n          this.setState({\n            stockHasBeenRemoved: true\n          });\n        }\n    } // getUserStocks(){\n    //     var user={ \n    //         email: this.state.email,\n    //     }\n    //     var url = \"/api/getUserStocks\";\n    //     const req = new Request(url,{\n    //         method:\"POST\",\n    //         headers:{\"Content-Type\":\"application/json\"},\n    //         body:JSON.stringify(user),\n    //     });\n    //     fetch(req)\n    //     .then((res)=>{\n    //         return res.json();\n    //     }).catch((error)=>{\n    //         console.log(\"p/121\");\n    //         console.log(error);\n    //         return Promise.reject(error);\n    //         })\n    //     .then(stock_results => {\n    //         console.log(\"3rdt ADD/remove Stock Rerender\");\n    //         this.setState({stocks:stock_results},()=>this.updatePage)});\n    // }\n    // updatePage(){\n    //     console.log(\"In update page \",this.state.stocks);\n    //     this.props.history.push(\"/profile\",[[{email:this.state.email}],this.state.stocks])\n    // }\n    // UpdateStockOnPage(){\n    //     if(this.state.stock_symbol_status === 'User had already added this stock'){\n    //         alert(\"This stock is already on your watchlist\");\n    //     }\n    //     else{\n    //         console.log(\"2nd ADD Stock Rerender\");\n    //         this.setState({stock_symbol_status:\"\",Remove_Status:\"\"},()=>this.getUserStocks());\n    //     }\n    // }\n    // addUserStock(){\n    //     if(this.state.stock_symbol_status !== \"stock not found\"){\n    //         console.log(\"Subscribing to \",this.state.stock_to_watch)\n    //         this.connection.send(JSON.stringify({'type':'subscribe', 'symbol': this.state.stock_to_watch}))\n    //         var user={\n    //             email:this.props.email,\n    //             addStock: this.state.stock_to_watch\n    //         } \n    //         var url=\"/api/AddUserStocks\";\n    //         const req = new Request(url,{\n    //             method:\"POST\",\n    //             headers:{\"Content-Type\":\"application/json\"},\n    //             body:JSON.stringify(user),\n    //         });\n    //         fetch(req)\n    //         .then((res)=>{\n    //             return res.json();\n    //         }).catch((error)=>{\n    //             return Promise.reject(error);\n    //           })\n    //         .then(result => {\n    //             console.log(\"1st ADD Stock Rerender\");\n    //             this.setState({stock_symbol_status: result},()=>this.UpdateStockOnPage())});\n    //     }\n    //     else{\n    //         //put in this functionality \n    //         alert(\"stock not found\");\n    //     }\n    // }\n    // handleChange(event) {\n    //     this.setState({stock_to_watch: event.target.value});\n    //   }\n\n  }, {\n    key: \"renderStockChart\",\n    value: function renderStockChart(event) {\n      console.log(event.dataItem.Symbol);\n      this.setState({\n        chartStock: event.dataItem.Symbol\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      // console.log(this.state.stocks);\n      // console.log(\"In render: \", this.state.stocks,this.props.stocks);\n      // // console.log(\"In render: \", this.state.dropdownDisplay);\n      // if (this.state == null){\n      //     this.props.history.push(\"/error\");\n      //     }\n      // var Message = \"Your WatchList\";\n      // if(this.state.stocks===\"No stocks added\"){\n      //     Message =\"Empty Watchlist\"; \n      // }\n      // var MessageArrowDir;\n      // if(this.state.dropdownOpen){\n      //   MessageArrowDir = \"\\u25BC\";\n      // }\n      // else{\n      //   MessageArrowDir = \"\\u25B2\";\n      // }\n      // var dropdownDisplay =\n      //     <> <div className = \"dropDiv\">\n      //         <Button className = \"FakeDropDown\" onClick = {(e)=>{this.doNothing(e)}}><span style={{marginLeft:\"55px\"}}>{Message}</span></Button>\n      //         <Button className = \"realDropDown \"onClick = {this.toggle} aria-expanded = {this.state.dropdownOpen}\n      //                 data-toggle = \"dropdown\" aria-haspopup=\"true\"><span style={{fontSize:\"18px\"}}>{MessageArrowDir}</span></Button>\n      //     </div></>\n      // var dropdown;\n      // if(this.state.stocks!==\"No stocks added\"){\n      // dropdown = \n      // <Dropdown style = {{marginBottom:\"20px\"}} isOpen={this.state.dropdownOpen}>\n      //     {dropdownDisplay}\n      //     <DropdownMenu className = \"DDM\">\n      //       <div className = \"ArtistsDisplayWrapper\">\n      //         {this.state.stocks.map((stocks,index) =>\n      //     <div className = \"ArtistLine\" style = {{marginBottom:\"55px\"}}>\n      //         <button  onClick = {(e)=>{this.doNothing(e)}} className = \"artistButton\">{stocks.Symbol}</button>\n      //         <button id = {stocks.symbol} onClick = {(e)=>{this.doNothing(e)}} className = \"playArtistButton\">${stocks.currentPrice}</button>\n      //         <button onClick = {(e)=>{this.removeStock(e,stocks.Symbol)}} className = \"removeButton\">X</button> \n      //     </div>\n      //         )}\n      //       </div>\n      //     </DropdownMenu>\n      // </Dropdown>\n      // }\n      // else{\n      //     dropdown = dropdownDisplay;\n      // }\n      // var trackButton = <Button onClick = {this.getStockInfo} className= \"Button\" id = \"TrackButton\" >Track </Button>;\n      // this.props.history.push(\"/error\",this.state)\n      // onClick={this.props.onClick}\n      var useData;\n\n      if (this.props.stocks !== \"No stocks added\") {\n        useData = this.props.stocks;\n\n        var grid = /*#__PURE__*/_jsxDEV(Tooltip, {\n          openDelay: 100,\n          position: \"right\",\n          children: /*#__PURE__*/_jsxDEV(Grid, {\n            data: useData,\n            onRowClick: this.renderStockChart,\n            title: \"WatchList\",\n            children: [/*#__PURE__*/_jsxDEV(GridColumn, {\n              title: \"Symbol\",\n              field: \"Symbol\",\n              style: {\n                width: 100\n              },\n              locked: false,\n              width: 100,\n              cell: this.symbolCell\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 611,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(GridColumn, {\n              title: \"Last Close\",\n              field: \"eodClose\",\n              cell: add$sign\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 612,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(GridColumn, {\n              title: \"Price\",\n              field: \"currentPrice\",\n              cell: ChangeCurPriceColor\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 613,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(GridColumn, {\n              title: \"Change\",\n              field: \"CurrentAmountChange\",\n              cell: ChangeCurChangeColor\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 614,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(GridColumn, {\n              title: \"% Change\",\n              field: \"CurrentPercentChange\",\n              cell: ChangeCurChangeColor\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 615,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(GridColumn, {\n              title: \"Track\",\n              id: \"Symbol\",\n              cell: this.CommandCell,\n              width: \"200px\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 617,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 609,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 608,\n          columnNumber: 13\n        }, this);\n      } else {\n        useData = [{\n          eodClose: \"Add stocks\",\n          Symbol: \"Add stocks\",\n          currentPrice: \"Add stocks\",\n          Change: \"Add stocks\",\n          CurrentAmountChange: \"Add stocks\",\n          CurrentPercentChange: \"Add stocks\",\n          Track: \"Add stocks\"\n        }];\n\n        var grid = /*#__PURE__*/_jsxDEV(Tooltip, {\n          openDelay: 100,\n          position: \"right\",\n          children: /*#__PURE__*/_jsxDEV(Grid, {\n            data: useData,\n            onRowClick: this.renderStockChart,\n            title: \"WatchList\",\n            children: [/*#__PURE__*/_jsxDEV(GridColumn, {\n              title: \"Symbol\",\n              field: \"Symbol\",\n              style: {\n                width: 100\n              },\n              locked: false,\n              width: 100\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 637,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(GridColumn, {\n              title: \"Last Close\",\n              field: \"eodClose\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 638,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(GridColumn, {\n              title: \"Price\",\n              field: \"currentPrice\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 639,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(GridColumn, {\n              title: \"Change\",\n              field: \"CurrentAmountChange\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 640,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(GridColumn, {\n              title: \"% Change\",\n              field: \"CurrentPercentChange\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 641,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(GridColumn, {\n              title: \"Track\",\n              field: \"Track\",\n              width: \"200px\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 642,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 636,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 635,\n          columnNumber: 13\n        }, this);\n      } // console.log(this.state.eodData)\n\n\n      return grid;\n    }\n  }]);\n\n  return WatchList;\n}(React.Component));\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"ChangeCurPriceColor\");\n$RefreshReg$(_c2, \"ChangeCurChangeColor\");","map":{"version":3,"sources":["/Users/samehrlich/Desktop/final-app/client/src/components/WatchList.jsx"],"names":["React","Component","ChildComponent","ListGroup","Button","DropdownMenu","Dropdown","withRouter","Grid","GridCellProps","GridColumn","ReactDOM","Tooltip","OverlayTrigger","MyCommandCell","sendEmail","request","require","add$sign","props","Value","dataItem","field","ChangeCurPriceColor","curValue","closeValue","color","ChangeCurChangeColor","value","viewChartOver","saveNewStockTrade","event","result","JSON","parse","data","Alerts","state","user_alerts","user_watchlist","stocks","type","forEach","symbol","tradePrice","filter","i","n","s","Symbol","length","currentPrice","p","toFixed","CurrentAmountChange","eodClose","CurrentPercentChange","uniqueSymbols","includes","alerts","alert","Identifier","movement","valuechange","email","movment","setState","CommandCell","bind","getEodData","symbolCell","removeStock","renderStockChart","removeHelper","AlertData","alertData","connectionError","dropdownOpen","stockHasBeenRemoved","chartStock","e","prevProps","prevState","console","log","history","push","undefined","removeStocks","stock_chart","symbols","watchlists","getsymbols","fullUrl","json","err","res","body","eod","keys","Object","map","key","newList","element","index","connection","WebSocket","stock","send","stringify","close","onopen","onmessage","onclose","htmlEvent","preventDefault","user","stock_symbol","url","req","Request","method","headers","fetch","then","status","message","stackTrace","catch","error","Promise","reject","remove_status","response","Response","useData","grid","width","Change","Track"],"mappings":"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","sourcesContent":["import React,{Component,ChildComponent} from \"react\";\nimport {ListGroup} from \"react-bootstrap/esm\";\nimport {Button,DropdownMenu,Dropdown,} from \"reactstrap/es\";\n// import {Tooltip,OverlayTrigger} from \"react-bootstrap\"\nimport {withRouter} from \"react-router-dom\";\nimport { Grid, GridCellProps, GridColumn } from \"@progress/kendo-react-grid\";\nimport * as ReactDOM from \"react-dom\";\nimport { Tooltip } from \"@progress/kendo-react-tooltip\";\nimport OverlayTrigger from 'react-bootstrap/OverlayTrigger';\nimport { MyCommandCell } from \"./mycommand.jsx\";\nimport \"hammerjs\";\nimport {sendEmail} from \"./email.js\"\n\nconst request = require('request');\n\nfunction add$sign(props){\n  const Value = props.dataItem[props.field || \"\"];\n  return (\n    <td >\n      {\"$\"+Value}\n    </td>\n  )\n}\nfunction ChangeCurPriceColor(props){\n  const curValue = props.dataItem[props.field || \"\"];\n  const closeValue =props.dataItem[\"eodClose\"||\"\"]\n  // console.log(curValue,closeValue)\n  return (\n    <td style={{ color: curValue > closeValue ? \"green\" : \"red\" }}>\n      {\"$\"+curValue}\n    </td>\n  )\n  \n};\nfunction ChangeCurChangeColor(props){\n  const value = props.dataItem[props.field || \"\"]>0? \"+\"+props.dataItem[props.field]:props.dataItem[props.field || \"\"];\n  \n  // console.log(curValue,closeValue)\n  return (\n    <td style={{ color: value > 0 ? \"green\" : \"red\" }}>\n      {value}%\n    </td>\n  )\n  \n};\nclass viewChartOver extends React.Component {\n  render() {\n    return (\n      <td title={\"View chart\"}>\n        {\"view the char\"}\n      </td>\n    );\n  }\n}\nexport default withRouter( class WatchList extends React.Component {\n \n    constructor(props) {\n        super(props)\n            this.CommandCell=this.CommandCell.bind(this)\n            this.getEodData=this.getEodData.bind(this)\n            this.symbolCell = this.symbolCell.bind(this);\n            this.removeStock=this.removeStock.bind(this);\n            this.renderStockChart=this.renderStockChart.bind(this);\n            this.removeHelper=this.removeHelper.bind(this);\n            // this.getButton=this.getButton.bind(this);\n            this.state={\n                email : this.props.email,\n                stocks:this.props.stocks,\n                AlertData:this.props.alertData,\n                connectionError: false,\n                dropdownOpen: false,\n                value:\"Your Watchlist\",\n                stockHasBeenRemoved:false,\n                chartStock:\"\",\n                // eodData:\"\"\n                \n            }\n            \n        \n        \n    }\n    symbolCell(props){\n      var symbol = props.dataItem[props.field || \"\"];\n      \n      return(\n        \n        \n        <td >\n        <button type=\"button\" className=\"btn btn-danger btn-circle btn-sm\" onClick={(e) =>\n  \n          this.removeStock(e,props.dataItem)\n}>X</button> {symbol}\n        </td>\n        \n   \n      );\n     \n\n\n    }\n    CommandCell(props){\n      return(\n        <MyCommandCell\n          {...props}\n          \n          remove={this.removeStock}\n          \n        />\n      );\n    }\n        \n      \n      componentDidUpdate(prevProps, prevState) {\n        if (prevState.stockHasBeenRemoved !== this.state.stockHasBeenRemoved) {\n          console.log('User has removed a stock.')\n          if(this.props.history.push!== undefined) {\n            this.setState({stockHasBeenRemoved:false},()=>this.props.history.push(\"/profile\",[[{email:this.state.email,removeStocks:true},this.state.stocks]]));\n          }\n          else{\n              this.setState({stocks:this.state.stocks})\n          }\n        }\n          if (this.props.stocks.length != prevProps.stocks.length) {\n            console.log('Update stocks')\n            this.setState({stocks:this.props.stocks})\n         \n        }\n        if(prevState.chartStock!==this.state.chartStock && this.state.chartStock!==\"\"){\n          var stock_chart= this.state.chartStock;\n          console.log(\"render chart for \", stock_chart);\n          \n          this.setState({chartStock:\"\"},()=>this.props.history.push(\"/profile\",[[{email:this.state.email,chartStock:stock_chart},this.state.stocks]]))\n        }\n      }\n      \n      // componentDidMount(){\n      //   // var data = getEodData(\"AAPL\");\n      //   // console.log(data);\n        \n      //   // this.setState({eodData:data})\n        \n      // }\n\n\n      //update this function to handle dynamic watchlist\n      getEodData(symbols){\n        if(symbols !== 'No stocks added'){\n          var watchlists = symbols;\n          var getsymbols =\"\";\n          var result = [];\n         \n          symbols.forEach(symbol=>{\n            getsymbols= getsymbols+symbol.Symbol\n            \n         \n          var fullUrl = 'https://www.alphavantage.co/query?function=GLOBAL_QUOTE&symbol='+getsymbols+'&apikey=2TXPYH4TGZ32RG8D';\n\n          //  var fullUrl= \"http://api.marketstack.com/v1/eod/latest?access_key=5dd6fd84e5ba4e974843da4e6e23db23&symbols=\"+getsymbols;\n          request(fullUrl, { json: true }, (err, res, body) => {\n            \n            if (err) { return console.log(err); }\n            var eod=body[\"Global Quote\"];\n            var keys = Object.keys(eod).map(key=>key);\n            // console.log(eod);\n            result.push(eod);\n          //   var newList = watchlists.map((element, index) =>{\n              \n          //     element.eodClose= (eod['05. price']*1).toFixed(2);\n              \n          //     element.CurrentAmountChange= \"\";\n          //     element.CurrentPercentChange= \"\";\n          //     return element\n          //   })\n          //   console.log(newList)\n          // this.setState({stocks:newList});\n          \n        }) })\n        console.log(result['0']);\n        var newList = watchlists.map((element, index) =>{\n              \n          element.eodClose= (result[index]['05. price']*1).toFixed(2);\n          \n          element.CurrentAmountChange= \"\";\n          element.CurrentPercentChange= \"\";\n          return element\n        })\n        console.log(newList)\n      this.setState({stocks:newList});\n      }\n        else{\n          console.log(\"No stocks added\")\n          return;\n        }\n      }\n//     getButton(){\n//         return(\n// <button className=\"k-button k-grid-remove-command\"onClick={(e) =>this.remove(e)}>Remove </button>\n//         )\n//     }\n    // remove(e,stocks){\n    //     console.log(stocks);\n    // }\n    componentWillMount(){\n      console.log(this.state.stocks)\n      this.connection = new WebSocket('wss://ws.finnhub.io?token=c34391qad3i8edlcgrgg');\n        if(this.state.stock!=='No stocks added'){\n          \n          this.getEodData(this.state.stocks);\n        }\n        \n        \n    }\n    componentWillUnmount(){\n        if(this.state.stock!=\"No stocks added\"){\n          this.state.stocks.forEach(symbol=>{\n            this.connection.send(JSON.stringify({'type':'unsubscribe', 'symbol': symbol.Symbol}));\n            \n          })\n          \n        }\n        \n        this.connection.close();\n        \n        \n        // Perform any necessary cleanup in this method, such as invalidating timers, canceling network requests, \n        // or cleaning up any subscriptions that were created in componentDidMount().\n    }\n    // componentDidUpdate(prevProps, prevState) {\n    //     if (prevProps.stocks !== this.props.stocks) {\n    //       console.log('stocks state has changed.')\n    //     //   this.props.history.push(\"/profile\",[[{email:this.state.email}],this.state.stocks]);\n    //         this.setState({stocks:this.props.stocks});\n    //     }\n    //   }\n    // toggle(event) {\n    //     this.setState({\n    //       dropdownOpen: !this.state.dropdownOpen,\n    //       value: event.currentTarget.textContent\n    //     });\n    //   }\n    saveNewStockTrade= (event) => {\n        \n        let result = JSON.parse(event.data)\n        // console.log(result)\n        let Alerts =this.state.user_alerts;\n        let user_watchlist = this.state.stocks\n        // console.log(\"InsidesaveNewStockTrade: \", user_watchlist)\n        if(result.type===\"trade\"){\n            user_watchlist.forEach(symbol => {\n                var tradePrice= result.data.filter((i,n)=>i.s===symbol.Symbol);\n                if(tradePrice.length !==0){\n                  \n                    // symbol.eodClose= (symbol.eodClose*1).toFixed(2);\n                    symbol.currentPrice = +tradePrice[tradePrice.length-1].p.toFixed(2); \n                    symbol.CurrentAmountChange= +(symbol.currentPrice-symbol.eodClose).toFixed(2);\n                    symbol.CurrentPercentChange= +((symbol.CurrentAmountChange/symbol.eodClose)*100).toFixed(2);\n                    // console.log(\"Found Updated price for \",symbol.Symbol,\"\\n\",\"Price: \",symbol.currentPrice)\n                    // console.log(\"Found Updating Amount Change, updated Change: \",symbol.CurrentAmountChange)\n                    // console.log(\"Found Updating Percent Change, updated Change: \",symbol.CurrentPercentChange)\n                    // socket.send(JSON.stringify({'type':'unsubscribe', 'symbol': symbol.name}))\n                }\n                if(Alerts.uniqueSymbols.includes(symbol.Symbol)){\n                  //check to see if the new price value triggered the alert\n                  Alerts.alerts.forEach(alert=>{\n                    if(alert.symbol===symbol){\n                      switch(alert.Identifier){\n                        case 'Price':\n                            switch(alert.movement){\n                                case 'Above':{\n                                  if(symbol.currentPrice > alert.valuechange){\n                                    alert(\"Your Price Alert watching for \"+symbol.Symbol+\" to go above: \"+alert.valuechange+\" has been triggered\")\n                                    sendEmail(this.state.email,alert);\n                                    return (\"Alert has been triggered\");\n                                  }\n                                  return (\"Above Alert not triggered\");\n                                }\n                                    \n                                case 'Below':{\n                                  if(symbol.currentPrice < alert.valuechange){\n                                    alert(\"Your Price Alert watching for \"+symbol.Symbol+\" to go below: \"+alert.valuechange+\" has been triggered\")\n                                    sendEmail(this.state.email,alert);\n                                    return (\"Alert has been triggered\");\n                                  }\n                                  return (\"Below Alert not triggered\");\n                                }\n                                \n                                default:\n                                    return (\"something went wrong\");\n                            }\n                        case 'Percent':\n                            switch(alert.movment){\n                                case 'Up':{\n                                  if(symbol.CurrentPercentChange > alert.valuechange){\n                                    alert(\"Your Percentage Alert watching for \"+symbol.Symbol+\" to be moving up: \"+alert.valuechange+\"% has been triggered\")\n                                    sendEmail(this.state.email,alert);\n                                    return (\"Alert has been triggered\");\n                                  }\n                                  return (\"Up Alert not triggered\");\n                                }\n                                    \n                                case 'Down':{\n                                  if(symbol.CurrentPercentChange < alert.valuechange){\n                                    alert(\"Your Percentage Alert watching for \"+symbol.Symbol+\" to be moving down: \"+alert.valuechange+\"% has been triggered\")\n                                    sendEmail(this.state.email,alert);\n                                    return (\"Down Alert has been triggered\");\n                                  }\n                                  return (\"Down Up Alert not triggered\");\n                                }\n                                default:\n                                  return (\"Down Alert not triggered\");\n                            }\n                        default:\n                          return (\"something went wrong\");\n                    \n                    }}\n                  })\n                  \n            }\n            \n        })\n        this.setState({stocks:user_watchlist});\n      }\n    }\n     \n    componentDidMount(){\n       \n        this.connection.onopen = ()=> { \n            if (this.state.stocks!==\"No stocks added\"){\n                this.state.stocks.forEach(symbol=>{\n                    this.connection.send(JSON.stringify({'type':'subscribe', 'symbol': symbol.Symbol}));\n                    console.log(\"Inside OnOpen: Subscribed To: \", symbol.Symbol)\n                })\n            }\n            else{\n                console.log(\"no stocks added to subscribe to\");\n            }\n            \n        }\n        this.connection.onmessage= this.saveNewStockTrade;\n        this.connection.onclose = () => { this.setState({connectionError: true}) }\n    }\n    \n    // updateDropdown(){\n    //     var Message = \"Your WatchList\";\n    //     if(this.state.stocks===\"No stocks added\"){\n    //         Message =\"Empty Watchlist\"; \n    //     }\n    //     var MessageArrowDir;\n    //     if(this.state.dropdownOpen){\n    //       MessageArrowDir = \"\\u25BC\";\n    //     }\n    \n    //     else{\n    //       MessageArrowDir = \"\\u25B2\";\n    //     }\n        \n    //     var header =\n    //         <> <div className = \"dropDiv\">\n    //             <Button className = \"FakeDropDown\" onClick = {(e)=>{this.doNothing(e)}}><span style={{marginLeft:\"55px\"}}>{Message}</span></Button>\n    \n    //             <Button className = \"realDropDown \"onClick = {this.toggle} aria-expanded = {this.state.dropdownOpen}\n    //                     data-toggle = \"dropdown\" aria-haspopup=\"true\"><span style={{fontSize:\"18px\"}}>{MessageArrowDir}</span></Button>\n    \n    //         </div></>\n        \n    //     if(this.state.stocks!==\"No stocks added\"){\n    //     var display = \n    //     <Dropdown style = {{marginBottom:\"20px\"}} isOpen={this.state.dropdownOpen}>\n    //         {header}\n    \n    //         <DropdownMenu className = \"DDM\">\n    //           <div className = \"ArtistsDisplayWrapper\">\n    //             {this.state.stocks.map((stocks,index) =>\n                \n    //         <div className = \"ArtistLine\" style = {{marginBottom:\"55px\"}}>\n                \n    //             <button  onClick = {(e)=>{this.doNothing(e)}} className = \"artistButton\">{stocks.Symbol}</button>\n    //             <button id = {stocks.symbol} onClick = {(e)=>{this.doNothing(e)}} className = \"playArtistButton\">${stocks.currentPrice}</button>\n    //             <button onClick = {(e)=>{this.removeStock(e,stocks.Symbol)}} className = \"removeButton\">X</button> \n    //         </div>\n    //             )}\n    //           </div>\n    //         </DropdownMenu>\n    //     </Dropdown>\n    //     this.setState({dropdownDisplay:display});\n    //             }\n    //             else{\n    //                 this.setState({dropdownDisplay:header});\n    //             }\n        \n\n    // }\n   \n    removeStock(htmlEvent,stock){\n        //unsubsribe from listening to thsi stock\n       console.log(\"Unsubscribing from: \",stock.Symbol)\n        this.connection.send(JSON.stringify({'type':'unsubscribe', 'symbol': stock}))\n        //first stop the htmlEvents default status\n        htmlEvent.preventDefault();\n        var user={\n            email:this.props.email,\n            stock_symbol: stock.Symbol,\n    \n        } \n        console.log(user)\n        var url = '/api/removeUserStock';\n        const req = new Request(url,{\n            method:\"POST\",\n            headers:{\"Content-Type\":\"application/json\"},\n            body:JSON.stringify(user),\n        });\n        fetch(req)\n        .then((res)=>{\n            console.log(res)\n            if(res.status===500){\n            res.json()\n            .then((json)=>{\n                const {message,stackTrace}=json;\n              })\n              .catch((error)=>{\n                return Promise.reject(error);\n              });\n            }\n            else{\n                \n              return res.json();\n            }\n          })\n          .then((result)=> {\n              \n              console.log(\"1st remove stock rerender\");\n              this.setState({remove_status:result},()=>this.removeHelper())});\n    \n    }\n    \n    removeHelper(){\n        console.log(\"p/179\",this.state.remove_status);\n        //removed but still showing on watch list\n        if(this.state.remove_status.response===\"Stock not on watch list\"){\n            alert(\"Stock Queued For Deletion, Please Login In Again\");\n        }\n        //stock has been removed from watchlist\n        else if(this.state.remove_status.Response===\"Sucessfully removed stock\"){\n            console.log(\"2nd remove stock rerender\");\n            this.setState({stockHasBeenRemoved:true});\n           \n        }\n    }\n    // getUserStocks(){\n    //     var user={ \n    //         email: this.state.email,\n    //     }\n    //     var url = \"/api/getUserStocks\";\n    //     const req = new Request(url,{\n    //         method:\"POST\",\n    //         headers:{\"Content-Type\":\"application/json\"},\n    //         body:JSON.stringify(user),\n    //     });\n    //     fetch(req)\n    //     .then((res)=>{\n           \n    //         return res.json();\n    //     }).catch((error)=>{\n    //         console.log(\"p/121\");\n    //         console.log(error);\n    //         return Promise.reject(error);\n    //         })\n    //     .then(stock_results => {\n    //         console.log(\"3rdt ADD/remove Stock Rerender\");\n    //         this.setState({stocks:stock_results},()=>this.updatePage)});\n        \n    // }\n    \n    // updatePage(){\n    //     console.log(\"In update page \",this.state.stocks);\n        \n    //     this.props.history.push(\"/profile\",[[{email:this.state.email}],this.state.stocks])\n        \n        \n        \n    // }\n    \n    // UpdateStockOnPage(){\n    //     if(this.state.stock_symbol_status === 'User had already added this stock'){\n    //         alert(\"This stock is already on your watchlist\");\n    //     }\n        \n    //     else{\n    //         console.log(\"2nd ADD Stock Rerender\");\n    //         this.setState({stock_symbol_status:\"\",Remove_Status:\"\"},()=>this.getUserStocks());\n    //     }\n    // }\n\n    // addUserStock(){\n    //     if(this.state.stock_symbol_status !== \"stock not found\"){\n    //         console.log(\"Subscribing to \",this.state.stock_to_watch)\n    //         this.connection.send(JSON.stringify({'type':'subscribe', 'symbol': this.state.stock_to_watch}))\n    //         var user={\n    //             email:this.props.email,\n    //             addStock: this.state.stock_to_watch\n    //         } \n           \n    //         var url=\"/api/AddUserStocks\";\n    //         const req = new Request(url,{\n    //             method:\"POST\",\n    //             headers:{\"Content-Type\":\"application/json\"},\n    //             body:JSON.stringify(user),\n    //         });\n    //         fetch(req)\n    //         .then((res)=>{\n                \n    //             return res.json();\n    //         }).catch((error)=>{\n    //             return Promise.reject(error);\n    //           })\n    //         .then(result => {\n    //             console.log(\"1st ADD Stock Rerender\");\n    //             this.setState({stock_symbol_status: result},()=>this.UpdateStockOnPage())});\n            \n    //     }\n    \n    //     else{\n    //         //put in this functionality \n    //         alert(\"stock not found\");\n    //     }\n        \n        \n    // }\n    // handleChange(event) {\n         \n    //     this.setState({stock_to_watch: event.target.value});\n    //   }\n\n    renderStockChart(event){\n      console.log(event.dataItem.Symbol)\n      this.setState({chartStock:event.dataItem.Symbol})\n    }\n    render(){\n      // console.log(this.state.stocks);\n    \n        // console.log(\"In render: \", this.state.stocks,this.props.stocks);\n        // // console.log(\"In render: \", this.state.dropdownDisplay);\n        // if (this.state == null){\n        //     this.props.history.push(\"/error\");\n        //     }\n        \n        \n        // var Message = \"Your WatchList\";\n        // if(this.state.stocks===\"No stocks added\"){\n        //     Message =\"Empty Watchlist\"; \n        // }\n        // var MessageArrowDir;\n        // if(this.state.dropdownOpen){\n        //   MessageArrowDir = \"\\u25BC\";\n        // }\n    \n        // else{\n        //   MessageArrowDir = \"\\u25B2\";\n        // }\n        \n        // var dropdownDisplay =\n        //     <> <div className = \"dropDiv\">\n        //         <Button className = \"FakeDropDown\" onClick = {(e)=>{this.doNothing(e)}}><span style={{marginLeft:\"55px\"}}>{Message}</span></Button>\n    \n        //         <Button className = \"realDropDown \"onClick = {this.toggle} aria-expanded = {this.state.dropdownOpen}\n        //                 data-toggle = \"dropdown\" aria-haspopup=\"true\"><span style={{fontSize:\"18px\"}}>{MessageArrowDir}</span></Button>\n    \n        //     </div></>\n        // var dropdown;\n        // if(this.state.stocks!==\"No stocks added\"){\n    \n        // dropdown = \n    \n        // <Dropdown style = {{marginBottom:\"20px\"}} isOpen={this.state.dropdownOpen}>\n        //     {dropdownDisplay}\n    \n        //     <DropdownMenu className = \"DDM\">\n        //       <div className = \"ArtistsDisplayWrapper\">\n        //         {this.state.stocks.map((stocks,index) =>\n                \n        //     <div className = \"ArtistLine\" style = {{marginBottom:\"55px\"}}>\n                \n        //         <button  onClick = {(e)=>{this.doNothing(e)}} className = \"artistButton\">{stocks.Symbol}</button>\n        //         <button id = {stocks.symbol} onClick = {(e)=>{this.doNothing(e)}} className = \"playArtistButton\">${stocks.currentPrice}</button>\n        //         <button onClick = {(e)=>{this.removeStock(e,stocks.Symbol)}} className = \"removeButton\">X</button> \n        //     </div>\n        //         )}\n        //       </div>\n        //     </DropdownMenu>\n        // </Dropdown>\n        // }\n        // else{\n        //     dropdown = dropdownDisplay;\n    \n           \n      \n        // }\n       \n        // var trackButton = <Button onClick = {this.getStockInfo} className= \"Button\" id = \"TrackButton\" >Track </Button>;\n        \n        // this.props.history.push(\"/error\",this.state)\n        // onClick={this.props.onClick}\n        var useData;\n\n        if(this.props.stocks !==\"No stocks added\"){\n          useData=this.props.stocks\n          var grid = (\n            <Tooltip openDelay={100} position=\"right\" >\n              <Grid data={useData} onRowClick= {this.renderStockChart} title=\"WatchList\">\n                {/* <GridColumn title=\"Name\" field=\"name\" /> */}\n                <GridColumn title=\"Symbol\" field=\"Symbol\"style={{ width: 100 }} locked={false} width={100} cell={this.symbolCell} />\n                <GridColumn title=\"Last Close\" field=\"eodClose\" cell={add$sign}/>\n                <GridColumn title=\"Price\" field=\"currentPrice\" cell={ChangeCurPriceColor}/>\n                <GridColumn title=\"Change\" field=\"CurrentAmountChange\" cell={ChangeCurChangeColor} />\n                <GridColumn title=\"% Change\" field=\"CurrentPercentChange\" cell={ChangeCurChangeColor}/>\n                {/* <GridColumn title=\"View Chart\" id=\"Symbol\" cell={tooltiprender} width=\"200px\" /> */}\n                <GridColumn title=\"Track\" id=\"Symbol\" cell={this.CommandCell} width=\"200px\" />\n              </Grid>\n            </Tooltip>\n         \n          )\n        }\n        else{\n          useData=[{\n            eodClose:\"Add stocks\",\n            Symbol:\"Add stocks\",\n            currentPrice:\"Add stocks\",\n            Change:\"Add stocks\",\n            CurrentAmountChange:\"Add stocks\",\n            CurrentPercentChange:\"Add stocks\",\n            Track:\"Add stocks\"\n\n          },]\n          var grid = (\n            <Tooltip openDelay={100} position=\"right\" >\n              <Grid data={useData} onRowClick= {this.renderStockChart} title=\"WatchList\">\n                <GridColumn title=\"Symbol\" field=\"Symbol\"style={{ width: 100 }} locked={false} width={100}  />\n                <GridColumn title=\"Last Close\" field=\"eodClose\" />\n                <GridColumn title=\"Price\" field=\"currentPrice\" />\n                <GridColumn title=\"Change\" field=\"CurrentAmountChange\" />\n                <GridColumn title=\"% Change\" field=\"CurrentPercentChange\" />\n                <GridColumn title=\"Track\" field=\"Track\" width=\"200px\" />\n              </Grid>\n            </Tooltip>\n          )\n        }\n        // console.log(this.state.eodData)\n        return (\n          \n          \n          grid\n          \n          );\n        }\n})\n"]},"metadata":{},"sourceType":"module"}